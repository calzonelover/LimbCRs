from ROOT import *
from math import *
from array import *
import numpy as np
oV=[(10**((float(i)/25)+1)) for i in range(51)]
V=array('d',oV)
dat=np.genfromtxt('testdat.olo')
dNlimb,Elimb,fluxlimb=dat[:,0],dat[:,1],dat[:,2]
dN1,E1,flux1=dat[:,6],dat[:,7],dat[:,8]
dN2,E2,flux2=dat[:,9],dat[:,10],dat[:,11]
dN3,E3,flux3=dat[:,12],dat[:,13],dat[:,14]
# Declare TH1F
Glimb=TH1F('Glimb','Glimb',len(V)-1,V)
G1=TH1F('G1','G1',len(V)-1,V)
G2=TH1F('G2','G2',len(V)-1,V)
G3=TH1F('G3','G3',len(V)-1,V)
# Declare diff
Glimb1=TH1F('Glimb1','Glimb1',len(V)-1,V)
Glimb2=TH1F('Glimb2','Glimb2',len(V)-1,V)
Glimb3=TH1F('Glimb3','Glimb3',len(V)-1,V)
flux275limb=[]
flux2751=[]
flux2752=[]
flux2753=[]
for i in range(50):
        flux275limb.append(fluxlimb[i]*(Elimb[i]**2.75))
        flux2751.append(flux1[i]*(E1[i]**2.75))
        flux2752.append(flux2[i]*(E2[i]**2.75))
        flux2753.append(flux3[i]*(E3[i]**2.75))
        Glimb.SetBinContent(i+1,flux275limb[i])
        Glimb.SetBinError(i+1,flux275limb[i]/sqrt(dNlimb[i]))
        G1.SetBinContent(i+1,flux2751[i])
        G1.SetBinError(i+1,flux2751[i]/sqrt(dN1[i]))
        G2.SetBinContent(i+1,flux2752[i])
        G2.SetBinError(i+1,flux2752[i]/sqrt(dN2[i]))
        G3.SetBinContent(i+1,flux2753[i])
        G3.SetBinError(i+1,flux2753[i]/sqrt(dN3[i]))
        Glimb1.SetBinContent(i+1,abs((fluxlimb[i]*(Elimb[i]**2.75))-(flux1[i]*(E1[i]**2.75))))
        Glimb2.SetBinContent(i+1,abs((fluxlimb[i]*(Elimb[i]**2.75))-(flux2[i]*(E2[i]**2.75))))
        Glimb3.SetBinContent(i+1,abs((fluxlimb[i]*(Elimb[i]**2.75))-(flux3[i]*(E3[i]**2.75))))
        #print flux275limb[i],flux2751[i],flux2752[i],flux2753[i]
C=TCanvas('C','C',800,600)
C.Divide(1,2)
C.cd(1)
C.cd(1).SetLogx()
C.cd(1).SetLogy()
Glimb.SetStats(0)
Glimb.SetMarkerStyle(20)
Glimb.SetTitle('oldlimb : #theta_{nadir} 68.4-70.0')
Glimb.SetLineColor(1)
Glimb.GetXaxis().SetTitle('E (GeV)')
Glimb.GetYaxis().SetTitle('E^{2.75}Flux (GeV^{1.75}s^{-1}sr^{-1}m^{-2})')
Glimb.Draw('E1')
Glimb.GetYaxis().SetRangeUser(1,1000)
G1.SetTitle('set 1 : #theta_{nadir} 66.0-70.0 (include earth)')
G1.SetMarkerStyle(22)
G1.SetMarkerColor(2)
G1.SetLineColor(2)
G1.Draw('Psame')
G2.SetTitle('set 2 : #theta_{nadir} 68.20-70.0 (mean)')
G2.SetMarkerStyle(33)
G2.SetMarkerColor(4)
G2.SetLineColor(4)
G2.Draw('Psame')
G3.SetTitle('set 3 : #theta_{nadir} 68.2-70.0 (peak)')
G3.SetMarkerStyle(34)
G3.SetMarkerColor(8)
G3.SetLineColor(8)
G3.Draw('Psame')
C.cd(1).BuildLegend()
Glimb.SetTitle('Plot 4 type of selection')
C.cd(2)
C.cd(2).SetLogx()
Glimb1.SetTitle('Diff oldlimb,set1')
Glimb1.SetMarkerStyle(22)
Glimb1.SetMarkerColor(2)
Glimb1.SetLineColor(0)
Glimb1.SetStats(0)
Glimb1.GetXaxis().SetTitle('E (GeV)')
Glimb1.GetYaxis().SetTitle('E^{2.75}Flux (GeV^{1.75}s^{-1}sr^{-1}m^{-2})')
Glimb1.GetYaxis().SetRangeUser(0.,100.)
Glimb1.Draw('P')
Glimb2.SetTitle('Diff oldlimb,set2')
Glimb2.SetMarkerStyle(33)
Glimb2.SetMarkerColor(4)
Glimb2.SetLineColor(0)
Glimb2.Draw('Psame')
Glimb3.SetTitle('Diff oldlimb,set3')
Glimb3.SetMarkerStyle(34)
Glimb3.SetMarkerColor(8)
Glimb3.SetLineColor(0)
Glimb3.Draw('Psame')
C.cd(2).BuildLegend()
Glimb1.SetTitle('Plot absolute different from oldcut (#theta_{nadir} 68.4-70.0)')
raw_input()
